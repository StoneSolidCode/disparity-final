// Base Code from to https://github.com/8to5Developer
// Editors: Jesse Tran, Jeewon Ha, Seohyung Lee

function getControlHrmlContent() {
    return '<div id="controlbox" style="padding-left:30px;" > ' +
                '<div id="boxcontainer" class="searchbox searchbox-shadow" > ' +
                    '<div class="searchbox-menu-container"> ' +
                        ' <button style="height:35px;" aria-label="Menu" id="searchbox-menubutton" class="searchbox-menubutton" onclick="toggleOutterSearchBox();"><p style="margin-top:-22px;">Expand</p></button> ' +
                        ' <span aria-hidden="true" style="display:none">' +
                            'Menu' +
                        '</span> ' +
                    ' </div> ' +
                    ' <div style="style:bold;font-size:18px;">Police Violence in the USA</div>' +
                ' </div> ' +
            ' </div> ' +
            ' <div class="panel" style="height:375px"> ' +
                ' <div class="panel-header"> '+
                    ' <div class="panel-header-container"> ' +
                        ' <span id="panel-header-title" class="panel-header-title"> ' +
                            '<div id="controlboxInner" style="padding-left:25px;" > ' +
                                '<div id="boxcontainerInner" class="searchbox searchbox-shadow" > ' +
                                    '<div class="searchbox-menu-container"> ' +
                                       ' <button aria-label="Menu" id="searchbox-menubuttonInner" class="searchbox-menubutton" onclick="toggleOutterSearchBox();"><p style="margin-top:-22px;">Hide</p></button> ' +
                                       ' <span aria-hidden="true" style="display:none">' +
                                           'Menu' +
                                      '</span> ' +
                                    ' </div> ' +
                                    ' <div style="color:black;font-size:18px;">Police Violence in the USA</div>' +
                                    ' <div class="searchbox-searchbutton-container"> ' +
                                        ' <button aria-label="search" id="searchbox-searchbuttonInner" class="searchbox-searchbutton"></button> ' +
                                        ' <span aria-hidden="true" style="display:none;">' +
                                            'search' +
                                        '</span> ' +
                                    ' </div> ' +
                                ' </div> ' +
                            ' </div> ' +
                        ' </span> ' +
                    ' </div> ' +
                ' </div> ' +
                ' <div class="panel-content"> ' +
                ' </div> ' +
            ' </div>'
}

function generateHtmlContent(a) {
    var b = '<ul class="panel-list">'
    b +='<li class="panel-list-item d-flex justify-content-center pt-0 pb-2">' +
        ' <div>' +
              '<p> Description </p><br />' +
              '<p>This map shows the disparity between the % population of African Americans and the percentage of police killings they make up. <br /></p>' +
              '<p> This data has the potential to influence those who may be questioning the authenticity of the Black Lives Matter movement. It gives reason to the anger we are seeing and shows doubters that there is a cause to protest for. </p><br />' +
              '<p> Having statistics and evidence is an important part of a movement. Creating and using visualizations like these has more of a potential to make change and get a reaction from authorities who have the power to enact reform. Its a more direct way of communication</p><br />' +
              '<a href="https://mappingpoliceviolence.org/">Mapping Police Violence Link</a><div> is a much better representation of the same data I am using. Feel free to have a look if you are wanting to see more statistics.<div/><br/>' + 
        ' </div>' +
      '</li>'

    return b + "</ul>"
}

function createSearchboxControl() {
    return L.Control.extend({
        _sideBarHeaderTitle: "Sample Title",
        _sideBarMenuItems: {
            Items: [
                {
                    type: "link",
                    name: "Link 1 (github.com)",
                    href: "http://github.com",
                    icon: "icon-local-carwash"
                },
                {
                    type: "link",
                    name: "Link 2 (google.com)",
                    href: "http://google.com",
                    icon: "icon-cloudy"
                },
                {
                    type: "button",
                    name: "Button 1",
                    onclick: "alert('button 1 clicked !')",
                    icon: "icon-potrait"
                },
                {
                    type: "button",
                    name: "Button 2",
                    onclick: "alert('button 2 clicked !')",
                    icon: "icon-local-dining"
                },
                {
                    type: "link",
                    name: "Link 3 (stackoverflow.com)",
                    href: "http://stackoverflow.com",
                    icon: "icon-bike"
                }
            ],
            _searchfunctionCallBack: function (a) { alert("calling the default search call back") }
        },
        options: { position: "topleft" },
        initialize: function (a) {
            L.Util.setOptions(this, a);
            a.sidebarTitleText && (this._sideBarHeaderTitle = a.sidebarTitleText);
            a.sidebarMenuItems && (this._sideBarMenuItems = a.sidebarMenuItems)
        },
        onAdd: function (a) {
            a = L.DomUtil.create("div");
            a.id = "controlcontainer";
            var b = this._sideBarHeaderTitle, d = this._sideBarMenuItems, c = this._searchfunctionCallBack;
            $(a).html(getControlHrmlContent());
            setTimeout(function () {
                //$("#panel-title").text(b);
                $(".searchbox-searchbutton").click(function () { var a = $("#searchboxinput").val(); c(a) });
                $("#searchbox-menubutton").click(function () {  $(".panel").toggle(/* "slide", { direction: "left" }, 700 */) });
                $("#searchbox-menubuttonInner").click(function () {  $(".panel").toggle(/* "slide", { direction: "left" }, 700 */) });
                $(".panel-close-button").click(function () { $(".panel").toggle(/*"slide", { direction: "left" }, 700 */) });
                $("#searchboxinput").keypress(function(e) { if(e.keyCode == 13){ $(".searchbox-searchbutton").click() } });
                $("#searchboxinputInner").keypress(function(e) { if(e.keyCode == 13){ $(".searchbox-searchbutton").click() } });
                //$("panel-header-container").append(function(){ addSearchBar()}   );

                //console.log(b)
                var a = generateHtmlContent(d); $(".panel-content").html(a)
            }, 1);
                L.DomEvent.disableClickPropagation(a);
                return a
        }
    })
};

function viewInfo() {
  var popup = document.getElementById("myModal");
  popup.style.display = "block";
  addInfo();
}

function addInfo() {
  var list = document.getElementById("myModal");
  console.log(list.childNodes.length)
  if (list.childNodes.length == 1) {
    var information = document.createElement("p");
    information.innerHTML = "GDP Unit: GDP per capita <br> Population Density Unit: Number of people per kilometer squared <br> Carbon Emission Unit: Kilograms of Carbor per meter squared per year";
    list.append(information);
  }
}

function hideInfo() {
  var popup = document.getElementById("myModal");
  popup.style.display = "none";
}

function toggleOutterSearchBox() {
    var controlBox = document.getElementById("controlbox");
    if ( controlBox.classList.contains("hidden") ) {
        controlBox.classList.remove("hidden")
    } else {
        controlBox.classList.add("hidden")
    }
}

function detectInputChange(position) {
    if (!position){
        $("#searchboxinput").val($("#searchboxinputInner").val())
    } else{
        $("#searchboxinputInner").val($("#searchboxinput").val())
    }
}
